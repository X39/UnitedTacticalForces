@using Microsoft.AspNetCore.Components.Sections
@using X39.UnitedTacticalForces.WebApp.Services
@inherits LayoutComponentBase
@inject IConfiguration Configuration
@inject IStringLocalizer Localizer
@inject MeService Me
@inject BaseUrl BaseUrl

<FluentLayout Style="margin-top: 10px;">
    <FluentHeader>
        <FluentImage Source="@BaseUrl.ResolveResourceUrl("insignia-48px.png")"/>
        <FluentSpacer/>
        @if (Me.IsAuthenticated)
        {
            <FluentProfileMenu Image="@Me.User.ToImageSource()"
                               FullName="@Me.User.Nickname"
                               EMail="@Me.User.EMail"
                               PopoverStyle="min-width: 330px;"
                               HeaderButton="@Localizer[nameof(Language.Shared_NavMenu_Logout)]"
                               FooterLabel="@Localizer[nameof(Language.Shared_NavMenu_UserSettings)]"/>
        }
        else
        {
            <FluentNavLink Href="@BaseUrl.ResolveApiUrl($"/Users/login/steam?returnUrl={BaseUrl.SelfUrl}")">
                <FluentImage
                    Source="https://steamcdn-a.akamaihd.net/steamcommunity/public/images/steamworks_docs/german/sits_small.png"/>
            </FluentNavLink>
        }
    </FluentHeader>

    <FluentStack Width="100%">
        <FluentNavMenu Width="250">
            @* <FluentNavLink Icon="@(new Icons.Regular.Size24.Home())" *@
            @*                Match="NavLinkMatch.All"> *@
            @*     @Localizer[nameof(Language.Shared_NavMenu_Social)] *@
            @* </FluentNavLink> *@
            <FluentNavLink Icon="@(new Icons.Regular.Size24.Calendar())"
                           Href="@BaseUrl.ResolveSelfUrl("events/upcoming")">
                @Localizer[nameof(Language.Shared_NavMenu_UpcommingEvents)]
            </FluentNavLink>

            @if (Me.HasBaseClaimOrModPackAdmin(Claims.Creation.ModPack, Claims.ResourceBased.ModPack.All))
            {
                <FluentNavLink Href="@BaseUrl.ResolveSelfUrl("data/mod-packs")"
                               Icon="@(new Icons.Regular.Size24.LauncherSettings())">
                    @Localizer[nameof(Language.Shared_NavMenu_ModPacks)]
                </FluentNavLink>
            }
            @if (Me.HasBaseClaimOrModPackAdmin(Claims.Creation.Terrain, Claims.ResourceBased.Terrain.All))
            {
                <FluentNavLink Href="@BaseUrl.ResolveSelfUrl("terrains")"
                               Icon="@(new Icons.Regular.Size24.Map())">
                    @Localizer[nameof(Language.Shared_NavMenu_Terrains)]
                </FluentNavLink>
            }

            @if (Me.HasBaseClaimOrUserAdmin(Claims.User.All))
            {
                <FluentNavLink Href="@BaseUrl.ResolveSelfUrl("users")"
                               Icon="@(new Icons.Regular.Size24.PeopleList())">
                    @Localizer[nameof(Language.Shared_NavMenu_Users)]
                </FluentNavLink>
            }

            @if (Me.HasBaseClaimOrUserAdmin(Claims.User.Roles))
            {
                <FluentNavLink Href="@BaseUrl.ResolveSelfUrl("roles")"
                               Icon="@(new Icons.Regular.Size24.PersonBoard())">
                    @Localizer[nameof(Language.Shared_NavMenu_Users)]
                </FluentNavLink>
            }

            @if (Me.HasBaseClaimOrServerAdmin(Claims.ResourceBased.Server.All))
            {
                <FluentNavLink Href="@BaseUrl.ResolveSelfUrl("servers")"
                               Icon="@(new Icons.Regular.Size24.Server())">
                    @Localizer[nameof(Language.Shared_NavMenu_GameServers)]
                </FluentNavLink>
            }
        </FluentNavMenu>

        <FluentBodyContent>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce quis lorem lacus.
            Ut id leo non enim feugiat ultrices. Proin vulputate volutpat urna nec iaculis.
            Integer dui lacus, fermentum sit amet aliquet in, scelerisque vitae dui.
            Nulla fringilla sagittis orci eu consectetur. Fusce eget dolor non lectus placerat
            tincidunt. Pellentesque aliquam non odio ac porttitor. Nam finibus mattis sagittis.
            Ut hendrerit porttitor massa in aliquam. Duis laoreet fringilla feugiat.
            Sed maximus, urna in fringilla posuere, enim urna bibendum justo, vel molestie nibh orci nec lectus.
            Etiam a varius justo. Aenean nisl ante, interdum eget vulputate eget, iaculis ut massa.
            Suspendisse maximus sed purus id molestie. Lorem ipsum dolor sit amet, consectetur adipiscing elit.
        </FluentBodyContent>
    </FluentStack>

    <FluentFooter>
        <SectionOutlet SectionName="Footer"/>
        <FluentSpacer/>
        @if (Configuration[Constants.Configuration.Urls.TeamSpeak3]
                 .IsNotNullOrWhiteSpace())
        {
            <FluentNavLink Icon="@(new Icons.Custom.TeamSpeak3Size24())"
                           Href="@Configuration[Constants.Configuration.Urls.TeamSpeak3]">
                <FluentText>@Localizer[nameof(Language.Shared_NavMenu_TeamSpeak3)]</FluentText>
            </FluentNavLink>
        }
        @if (Configuration[Constants.Configuration.Urls.Discord]
                 .IsNotNullOrWhiteSpace())
        {
            <FluentNavLink Href="@Configuration[Constants.Configuration.Urls.Discord]">
                <FluentText>@Localizer[nameof(Language.Shared_NavMenu_Discord)]</FluentText>
            </FluentNavLink>
        }
        <FluentNavLink Href="@BaseUrl.ResolveSelfUrl("gdpr")" Icon="@(new Icons.Regular.Size24.Shield())">
            <FluentText>@Localizer[nameof(Language.Shared_NavMenu_GDPR)]</FluentText>
        </FluentNavLink>
    </FluentFooter>
</FluentLayout>


<FluentToastProvider/>
<FluentDialogProvider/>
<FluentTooltipProvider/>
<FluentMessageBarProvider/>
<FluentMenuProvider/>
